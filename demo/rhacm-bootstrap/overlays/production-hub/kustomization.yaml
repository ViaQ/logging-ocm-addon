apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: openshift-logging

resources:
- ../../base

configMapGenerator:
- name: hub-log-storage-config
  envs:
  - hub-log-storage-config.env
  options:
    disableNameSuffixHash: true

secretGenerator:
- name: hub-lokistack-s3-credentials
  envs:
  - hub-lokistack-s3-credentials.env
  type: Opaque
  options:
    disableNameSuffixHash: true

replacements:
- source:
    kind: ManagedClusterSet
    name: hub-logging-clusters
    fieldPath: metadata.name
  targets:
  - select:
      kind: Placement
      name: placement-policy-hub-logging
    fieldPaths:
    - spec.clusterSets.0
    options:
      create: true
  - select:
      kind: ManagedClusterSetBinding
      name: hub-logging-clusters
    fieldPaths:
    - metadata.name
    - spec.clusterSet
    options:
      create: true
- source:
    kind: ManagedClusterSet
    name: spoke-logging-clusters
    fieldPath: metadata.name
  targets:
  - select:
      kind: Placement
      name: placement-policy-spoke-logging
    fieldPaths:
    - spec.clusterSets.0
    options:
      create: true
  - select:
      kind: ManagedClusterSetBinding
      name: spoke-logging-clusters
    fieldPaths:
    - metadata.name
    - spec.clusterSet
    options:
      create: true
